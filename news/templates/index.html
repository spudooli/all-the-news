{% extends 'base.html' %}
{% set active_page = section %}

 {% block content %}

 <div class="container mt-5">
    <div class="row">
        <div class="col-sm-9">
            <h2 class="section"> {{ section }}</h2>
        
            {% for clusterid, items in item1 | sort(attribute='clustercount') | groupby("clusterid")  %}
            {% for item in items  %}
                    
                    {% if loop.index == 1 %}
                    <div data-sort="{{ item.clustercount }}">
                    <div class="headline"><a href="{{ item.url }}">{{ item.headline}}</a></div>
                    <div class="short"> {{item.summary}} <div class="sourcename">{{item.source}} &nbsp;&nbsp;&nbsp; {{ item.pubdate|default('') }}</div></div>
                    {% else %}
                    <div class="secondaryitems">                  
                    <div class="headline-other"><a href="{{ item.url }}">{{ item.headline}}</a></div>
                    <div class="short"> {{item.summary}}  <div class="sourcename">{{item.source}}</div></div>
                    </div>  
                    {% endif %}
                    {% endfor %}
                    </div>
                <hr>
              {% endfor %}
        </div>

        <!-- Start right column -->
        <div class="col-sm-3">
            

            <div class="sidebar">
                <div class="liveupdates" id="liveupdates">&nbsp;</div>


                <h4>Some Trending Things</h4>

                {% for category, feature in featured | groupby("category")  %}
                
                {{ category}}

                {% for thing in feature  %}
                <ul>
                  <li><a href="/trending/{{thing.url }}">{{ thing.title }}</a></li>
               </ul>
               {% endfor %}
               {% endfor %}
        </div>  
        <!-- End right column -->


    </div>
</div>

<script src="/static/js/jquery-3.6.0.min.js" type="text/javascript"></script>
<script>



  function liveupdates() {
    $.get('/liveupdates/{{ lastid }}', function (data) {
      $('#liveupdates').html(data);
    });
  }

  $(document).ready(function () {
    setInterval(liveupdates, 600000);
  });

  function start() {
    liveupdates();
  }

  window.onload = start;
</script>


        {% endblock %}
